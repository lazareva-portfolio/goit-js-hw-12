{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from 'axios';\n\nconst inputSearchImages = document.querySelector('.input-search');\nconst formSearchImages = document.getElementById('search-form');\nconst gallery = document.getElementById('gallery');\nconst loadMoreButton = document.querySelector('.load-more-button');\nconst endMessage = document.querySelector('.end-message');\nlet lightbox;\n\n\nlet currentPage = 1;\nlet loadedImages = [];\nlet currentKeyword = '';\n\nformSearchImages.addEventListener('submit', async function (event) {\n  event.preventDefault();\n  currentPage = 1;\n  loadedImages = [];\n  const keyword = inputSearchImages.value.trim();\n\n  if (keyword) {\n    showLoadingSpinner();\n    if (keyword !== currentKeyword) {\n      currentKeyword = keyword;\n      clearGallery();\n    }\n    await searchImages(keyword, currentPage);\n  } else {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search keyword.',\n    });\n  }\n});\n\nloadMoreButton.addEventListener('click', async function () {\n\n  const keyword = inputSearchImages.value.trim();\n  if (keyword !== currentKeyword) {\n    lightbox = new SimpleLightbox('a[data-lightbox=\"gallery\"]');\n    lightbox.refresh();\n    clearGallery();\n    currentPage++;\n    showLoadingSpinner();\n  }\n  await searchImages(keyword, currentPage);\n});\n\nasync function searchImages(keyword, page) {\n  try {\n    const response = await axios.get(`https://pixabay.com/api/?key=29942317-e3405ade5aa33d4d063a2fbeb&q=${keyword}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=15`);\n    const totalHits = response.data.totalHits;\nconst totalPages = totalHits / 15;\n    hideLoadingSpinner();\n\n    if (response.data.hits.length > 0) {\n      const newImages = response.data.hits;\n      loadedImages = loadedImages.concat(newImages);\n\n      renderImages(loadedImages);\n\n      const lastImage = document.querySelector('.gallery a:last-child');\n      const sizeImage = document.querySelector('.gallery a');\n      if (lastImage) {\n        const lastImageRect = lastImage.getBoundingClientRect();\n        const imageRect = sizeImage.getBoundingClientRect();\n        const windowHeight = window.innerHeight;\n        const scrollDistance = lastImageRect.bottom - windowHeight - imageRect.height * 4;\n        window.scrollBy({\n          top: scrollDistance,\n          behavior: 'smooth',\n        });\n      }\n\n      loadMoreButton.style.display = 'block';\n    } else {\n      loadMoreButton.style.display = 'none';\n      endMessage.style.display = 'block';\n    }\n  } catch (error) {\n    hideLoadingSpinner();\n    console.log(error);\n  }\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = '';\n}\n\nfunction showLoadingSpinner() {\n  gallery.innerHTML = '<p>Loading images, please wait...</p>';\n}\n\nfunction hideLoadingSpinner() {\n  gallery.innerHTML = '';\n}\n\nfunction renderImages(images) {\n  const lightboxImages = [];\n  const imageList = images.map((image) => {\n    lightboxImages.push({\n      src: image.largeImageURL,\n      title: `Likes: ${image.likes}, Views: ${image.views}, Comments: ${image.comments}, Downloads: ${image.downloads}`,\n    });\n    return `<a href=\"${image.largeImageURL}\" data-lightbox=\"gallery\" data-title=\"${image.tags}\">\n              <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n              <ul>\n                <li>Likes:<br /> ${image.likes}</li>\n                <li>Views:<br /> ${image.views}</li>\n                <li>Comments:<br /> ${image.comments}</li>\n                <li>Downloads:<br /> ${image.downloads}</li>\n              </ul>\n            </a>`;\n  }).join('');\n\n  gallery.innerHTML += imageList;\n\n  lightbox = new SimpleLightbox('a[data-lightbox=\"gallery\"]');\n  lightbox.refresh();\n}\n\n"],"names":["inputSearchImages","formSearchImages","gallery","loadMoreButton","endMessage","lightbox","currentPage","loadedImages","currentKeyword","event","keyword","showLoadingSpinner","clearGallery","searchImages","iziToast","SimpleLightbox","page","response","axios","totalPages","hideLoadingSpinner","newImages","renderImages","lastImage","sizeImage","lastImageRect","imageRect","windowHeight","scrollDistance","error","images","lightboxImages","imageList","image"],"mappings":"owBAOA,MAAMA,EAAoB,SAAS,cAAc,eAAe,EAC1DC,EAAmB,SAAS,eAAe,aAAa,EACxDC,EAAU,SAAS,eAAe,SAAS,EAC3CC,EAAiB,SAAS,cAAc,mBAAmB,EAC3DC,EAAa,SAAS,cAAc,cAAc,EACxD,IAAIC,EAGAC,EAAc,EACdC,EAAe,CAAA,EACfC,EAAiB,GAErBP,EAAiB,iBAAiB,SAAU,eAAgBQ,EAAO,CACjEA,EAAM,eAAc,EACpBH,EAAc,EACdC,EAAe,CAAA,EACf,MAAMG,EAAUV,EAAkB,MAAM,KAAI,EAExCU,GACFC,IACID,IAAYF,IACdA,EAAiBE,EACjBE,KAEF,MAAMC,EAAaH,EAASJ,CAAW,GAEvCQ,EAAS,MAAM,CACb,MAAO,QACP,QAAS,gCACf,CAAK,CAEL,CAAC,EAEDX,EAAe,iBAAiB,QAAS,gBAAkB,CAEzD,MAAMO,EAAUV,EAAkB,MAAM,KAAI,EACxCU,IAAYF,IACdH,EAAW,IAAIU,EAAe,4BAA4B,EAC1DV,EAAS,QAAO,EAChBO,IACAN,IACAK,KAEF,MAAME,EAAaH,EAASJ,CAAW,CACzC,CAAC,EAED,eAAeO,EAAaH,EAASM,EAAM,CACzC,GAAI,CACF,MAAMC,EAAW,MAAMC,EAAM,IAAI,qEAAqER,CAAO,iEAAiEM,CAAI,cAAc,EAE9LG,EADgBF,EAAS,KAAK,UACL,GAG3B,GAFAG,IAEIH,EAAS,KAAK,KAAK,OAAS,EAAG,CACjC,MAAMI,EAAYJ,EAAS,KAAK,KAChCV,EAAeA,EAAa,OAAOc,CAAS,EAE5CC,EAAaf,CAAY,EAEzB,MAAMgB,EAAY,SAAS,cAAc,uBAAuB,EAC1DC,EAAY,SAAS,cAAc,YAAY,EACrD,GAAID,EAAW,CACb,MAAME,EAAgBF,EAAU,wBAC1BG,EAAYF,EAAU,wBACtBG,EAAe,OAAO,YACtBC,EAAiBH,EAAc,OAASE,EAAeD,EAAU,OAAS,EAChF,OAAO,SAAS,CACd,IAAKE,EACL,SAAU,QACpB,CAAS,CACF,CAEDzB,EAAe,MAAM,QAAU,OACrC,MACMA,EAAe,MAAM,QAAU,OAC/BC,EAAW,MAAM,QAAU,OAE9B,OAAQyB,EAAO,CACdT,IACA,QAAQ,IAAIS,CAAK,CAClB,CACH,CAEA,SAASjB,GAAe,CACtBV,EAAQ,UAAY,EACtB,CAEA,SAASS,GAAqB,CAC5BT,EAAQ,UAAY,uCACtB,CAEA,SAASkB,GAAqB,CAC5BlB,EAAQ,UAAY,EACtB,CAEA,SAASoB,EAAaQ,EAAQ,CAC5B,MAAMC,EAAiB,CAAA,EACjBC,EAAYF,EAAO,IAAKG,IAC5BF,EAAe,KAAK,CAClB,IAAKE,EAAM,cACX,MAAO,UAAUA,EAAM,KAAK,YAAYA,EAAM,KAAK,eAAeA,EAAM,QAAQ,gBAAgBA,EAAM,SAAS,EACrH,CAAK,EACM,YAAYA,EAAM,aAAa,yCAAyCA,EAAM,IAAI;AAAA,0BACnEA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA,mCAE7BA,EAAM,KAAK;AAAA,mCACXA,EAAM,KAAK;AAAA,sCACRA,EAAM,QAAQ;AAAA,uCACbA,EAAM,SAAS;AAAA;AAAA,kBAGnD,EAAE,KAAK,EAAE,EAEV/B,EAAQ,WAAa8B,EAErB3B,EAAW,IAAIU,EAAe,4BAA4B,EAC1DV,EAAS,QAAO,CAClB"}